<skuidpage personalizationmode="server" showsidebar="false" showheader="false" theme="ElixirThemepPlan">
  <models>
    <model id="GH_AnySObjectModel" query="true" createrowifnonefound="false" datasource="Ui-Only" processonclient="true">
      <fields>
        <field id="Id" displaytype="TEXT" defaultvaluetype="param" defaultValue="id" enclosevalueinquotes="true" value="id" label="Id"/>
        <field id="Prefix" displaytype="TEXT" label="Prefix" ogdisplaytype="TEXT" readonly="false" returntype="TEXT" length="3"/>
        <field id="SObjectType" displaytype="TEXT" defaultvaluetype="fieldvalue" defaultValue="" value="sobjecttype" enclosevalueinquotes="true"/>
      </fields>
      <conditions/>
      <actions/>
    </model>
    <model id="GH_AnyAttachmentModel" limit="" query="true" createrowifnonefound="false" datasource="salesforce" type="" sobject="Attachment">
      <fields>
        <field id="ParentId"/>
        <field id="Parent.Name"/>
      </fields>
      <conditions/>
      <actions/>
    </model>
  </models>
  <components>
    <grid uniqueid="sk-3CzWdY-212" columngutter="0px" cssclass="cls-header" rowgutter="0px">
      <divisions>
        <division behavior="flex" minwidth="75%" ratio="1" verticalalign="top">
          <components>
            <image source="staticresource" uniqueid="logo-image" resource="genesisExtn__CLSStyleSheetPack" datasource="salesforce" behavior="none" path="images/CL_Originate_Logo_BW.png" resourceContentType="application/zip">
              <styles>
                <styleitem type="itemsize"/>
                <styleitem type="border"/>
              </styles>
            </image>
          </components>
        </division>
        <division behavior="specified" verticalalign="top" width="25%">
          <components>
            <pagetitle uniqueid="application-header-buttons-panel" model="GH_AnySObjectModel">
              <actions>
                <action type="multi" label="Team Communication" cssclass="iconic-button iconic-button-loan-team-communication" uniqueid="loan-team-communication">
                  <hotkeys/>
                  <renderconditions logictype="and">
                    <rendercondition type="blank" operator="!=" fieldmodel="GH_AnySObjectModel" sourcetype="param" sourceparam="id" value="null" enclosevalueinquotes="false"/>
                  </renderconditions>
                  <enableconditions/>
                  <actions>
                    <action type="custom" snippet="manageLoanTeamCommunication"/>
                  </actions>
                </action>
                <action type="multi" label="Notes" cssclass="iconic-button iconic-button-notes-list" uniqueid="manage-notes">
                  <renderconditions logictype="and">
                    <rendercondition type="blank" operator="!=" fieldmodel="GH_AnySObjectModel" sourcetype="param" sourceparam="id" value="null" enclosevalueinquotes="false"/>
                  </renderconditions>
                  <enableconditions/>
                  <actions>
                    <action type="custom" snippet="ManageApplicationNotes"/>
                  </actions>
                </action>
                <action type="multi" label="Notifications" cssclass="iconic-button iconic-button-notifications-list" uniqueid="manage-my-tasks">
                  <renderconditions logictype="and">
                    <rendercondition type="blank" operator="!=" fieldmodel="GH_AnySObjectModel" sourcetype="param" sourceparam="id" value="null" enclosevalueinquotes="false"/>
                  </renderconditions>
                  <enableconditions/>
                  <actions>
                    <action type="custom" snippet="ManageMyTasks"/>
                  </actions>
                </action>
                <action type="multi" label="Team Members" cssclass="iconic-button iconic-button-user-list" uniqueid="manage-loan-team-members">
                  <renderconditions logictype="and">
                    <rendercondition type="blank" operator="!=" fieldmodel="GH_AnySObjectModel" sourcetype="param" field="Id" value="null" enclosevalueinquotes="false" sourceparam="id"/>
                  </renderconditions>
                  <enableconditions logictype="and"/>
                  <actions>
                    <action type="custom" snippet="ManageLoanTeamPopOver"/>
                  </actions>
                </action>
                <action type="multi" label="Task List" cssclass="iconic-button iconic-button-task-list" uniqueid="manage-stages">
                  <actions>
                    <action type="blockUI" message="Loading tasks..." timeout="3000"/>
                    <action type="custom" snippet="ManageStages"/>
                  </actions>
                  <hotkeys/>
                  <renderconditions logictype="and">
                    <rendercondition type="blank" operator="!=" fieldmodel="GH_AnySObjectModel" sourcetype="param" sourceparam="id" value="null" enclosevalueinquotes="false"/>
                  </renderconditions>
                  <enableconditions/>
                </action>
                <action type="multi" label="Application List" cssclass="iconic-button iconic-button-application-list" uniqueid="sk-6qg-218">
                  <actions>
                    <action type="redirect" window="blank" url="/{{{$Model.GH_AnySObjectModel.data.0.Prefix}}}/o"/>
                  </actions>
                  <renderconditions logictype="and"/>
                  <enableconditions/>
                </action>
              </actions>
              <renderconditions logictype="and">
                <rendercondition type="fieldvalue" operator="=" enclosevalueinquotes="true" fieldmodel="GH_AnySObjectModel" sourcetype="fieldvalue" nosourcerowbehavior="deactivate" field="SObjectType" value="genesis__Applications__c"/>
              </renderconditions>
            </pagetitle>
            <pagetitle uniqueid="account-header-buttons-panel" model="GH_AnySObjectModel">
              <actions>
                <action type="multi" label="Account List" cssclass="iconic-button iconic-button-application-list" uniqueid="sk-6qg-224">
                  <actions>
                    <action type="redirect" window="blank" url="/{{{$Model.GH_AnySObjectModel.data.0.Prefix}}}/o"/>
                  </actions>
                </action>
              </actions>
              <renderconditions logictype="and">
                <rendercondition type="fieldvalue" operator="=" enclosevalueinquotes="true" fieldmodel="GH_AnySObjectModel" sourcetype="fieldvalue" nosourcerowbehavior="deactivate" field="SObjectType" value="Account"/>
              </renderconditions>
            </pagetitle>
          </components>
        </division>
      </divisions>
      <styles>
        <styleitem type="background" bgtype="color">
          <styles>
            <styleitem property="background-color" value="#37444e"/>
          </styles>
        </styleitem>
      </styles>
    </grid>
  </components>
  <resources>
    <labels/>
    <javascript>
      <jsitem location="staticresource" name="JQueryPopoverUIPack" cachelocation="false" url="" namespace="genesisExtn" filepath="jquery.webui-popover.min.js">var params = arguments[0],
	$ = skuid.$;
</jsitem>
      <jsitem location="staticresource" name="CLSNGUIComponent" cachelocation="false" url="" namespace="genesisExtn" filepath="messageUtils.js">var params = arguments[0],
	$ = skuid.$;
</jsitem>
      <jsitem location="staticresource" name="CLSNGUIComponent" cachelocation="false" url="" namespace="genesisExtn" filepath="commonUtils.js">var params = arguments[0],
	$ = skuid.$;
</jsitem>
      <jsitem location="inline" name="UpdateSobjectTypeOnLoad" cachelocation="false" url="">(function(skuid){
	var $ = skuid.$;
	$(document.body).one('pageload',function(){
	    // determine sobject type and prefix
	    if(skuid.page.params.id){
	        getDataFromId();
	    } else if(skuid.page.params.sobjecttype){
	        getDataFromSobjectType();
	    } else {
	        skuid.page.params.sobjecttype = 'genesis__Applications__c';
	        getDataFromSobjectType();
	    }
	    // show button labels as icons
	    showIconicBtnLabelAsTooltip();
	});

    // determine sobject type and prefix from param id
    function getDataFromId(){
        var sobjectPrefix = skuid.page.params.id.substring(0,3);
        var sobjectType = getSobjectType(sobjectPrefix);
        updateUIModel(sobjectType, sobjectPrefix);
    }

    // determine sobject type and prefix from param sobjecttype
    function getDataFromSobjectType(){
        var sobjectType = skuid.page.params.sobjecttype;
        var sobjectPrefix = getSobjectPrefix(sobjectType);
        updateUIModel(sobjectType, sobjectPrefix);
    }
	
	//create a new row in model to set sobject type and prefix
    function updateUIModel(sobjectType, sobjectPrefix){
        skuid.$M("GH_AnySObjectModel").createRow({
            additionalConditions: [
                { field: 'SObjectType', value: sobjectType},
                { field: 'Prefix', value: sobjectPrefix},
            ], doAppend: true
        });
    }
    
	// get sobject name from sobject prefix
	function getSobjectType(prefix) {
        var selectedObjectType;
        // skuid gets object prefix for any polymorphic fields like parentid field on attachment
        skuid.$M("GH_AnyAttachmentModel").getField("ParentId").referenceTo.forEach(function(relatedObject){
            if(relatedObject.keyPrefix == prefix){
                selectedObjectType = relatedObject.objectName;
                return false;
            }
        });
        return selectedObjectType;
    }

    // get sobject prefix from sobject type
	function getSobjectPrefix(sobjectType) {
        var prefix;
        // skuid gets object prefix for any polymorphic fields like parentid field on attachment
        skuid.$M("GH_AnyAttachmentModel").getField("ParentId").referenceTo.forEach(function(relatedObject){
            if(relatedObject.objectName == sobjectType){
                prefix = relatedObject.keyPrefix;
                return false;
            }
        });
        return prefix;
    }

})(skuid);</jsitem>
      <jsitem location="inlinesnippet" name="ManageStages" cachelocation="false">var params = arguments[0],
	$ = skuid.$;

var popover = $('.webui-popover')[0];
if (popover &amp;&amp; $(popover).is(':visible')) {
	$('.webui-popover').remove();
} else {
    $('#manage-stages').webuiPopover({
	    trigger: 'manual',
	    type : 'iframe',
	    url: '/apex/skuid__ui?page=NGTaskList&amp;id=' + sessionStorage.getItem('selectApplicationId'),
	    width: '620px',
	    placement: 'bottom-left',
		closeable: true,
		onShow: function(element) {
    			var popover = element[0];
    			$(popover).css('bottom', 0);
    			$(popover).find('.webui-popover-content').css('padding', 0);
    			$(popover).find('.webui-popover-content &gt; iframe').attr('id', 'task-list-popover');
    			$(popover).find('.webui-popover-content &gt; iframe').css('width', '600px');
    			$(popover).find('.webui-popover-content &gt; iframe').css('height', $(popover).css('height'));
		},
		onHide: function() {
		    $('.webui-popover').remove();
		}
	});
	$('#manage-stages').webuiPopover('show');
}</jsitem>
      <jsitem location="inlinesnippet" name="ManageLoanTeamPopOver" cachelocation="false">var params = arguments[0],
	$ = skuid.$;
console.log(' popup session app id :: ' + sessionStorage.selectApplicationId);
var popover = $('.webui-popover')[0];
if (popover &amp;&amp; $(popover).is(':visible')) {
	$('.webui-popover').remove();
} else {
	$('#manage-loan-team-members').webuiPopover({
	    trigger: 'manual',
	    type : 'iframe',
	    url: '/apex/skuid__ui?page=LoanTeamMembers&amp;id=' + sessionStorage.getItem('selectApplicationId'),
	    width: '620px',
	    placement: 'bottom-left',
		closeable: true,
		onShow: function(element) {
    			var popover = element[0];
    			$(popover).css('bottom', 0);
    			$(popover).find('.webui-popover-content').css('padding', 0);
    			$(popover).find('.webui-popover-content &gt; iframe').css('width', '600px');
    			$(popover).find('.webui-popover-content &gt; iframe').css('height', $(popover).css('height'));
		},
		onHide: function() {
		    $('.webui-popover').remove();
		}
	});
	$('#manage-loan-team-members').webuiPopover('show');
}</jsitem>
      <jsitem location="inlinesnippet" name="ManageApplicationNotes" cachelocation="false">var params = arguments[0],
	$ = skuid.$;
var popover = $('.webui-popover')[0];

if (popover &amp;&amp; $(popover).is(':visible')) {
	$('.webui-popover').remove();
} else {
	$('#manage-notes').webuiPopover({
	    trigger: 'manual',
	    type : 'iframe',
	    url: '/apex/skuid__ui?page=ManageApplicationNotes&amp;id=' + sessionStorage.getItem('selectApplicationId'),
	    width: '620px',
	    placement: 'bottom-left',
		closeable: true,
		onShow: function(element) {
    			var popover = element[0];
    			$(popover).css('bottom', 0);
    			$(popover).find('.webui-popover-content').css('padding', 0);
    			$(popover).find('.webui-popover-content &gt; iframe').css('width', '600px');
    			$(popover).find('.webui-popover-content &gt; iframe').css('height', $(popover).css('height'));
		},
		onHide: function() {
		    $('.webui-popover').remove();
		}
	});
	$('#manage-notes').webuiPopover('show');
}</jsitem>
      <jsitem location="inlinesnippet" name="ManageMyTasks" cachelocation="false">var params = arguments[0],
	$ = skuid.$;
var appId = sessionStorage.selectApplicationId;
var popover = $('.webui-popover')[0];
if (popover &amp;&amp; $(popover).is(':visible')) {
	$('.webui-popover').remove();
} else {
    $('#manage-my-tasks').webuiPopover({
		trigger: 'manual',
		type: 'iframe',
		url: '/apex/skuid__ui?page=UserNotificationList&amp;id=' + sessionStorage.getItem('selectApplicationId'),
		width: '620px',
		placement: 'bottom-left',
		closeable: true,
		onShow: function(element) {
			var popover = element[0];
			$(popover).css('bottom', 0);
			$(popover).find('.webui-popover-content').css('padding', 0);
			$(popover).find('.webui-popover-content &gt; iframe').css('width', '600px');
			$(popover).find('.webui-popover-content &gt; iframe').css('height', $(popover).css('height'));
		},
		onHide: function() {
		    $('.webui-popover').remove();
		}
	});
	$('#manage-my-tasks').webuiPopover('show');
}</jsitem>
      <jsitem location="inlinesnippet" name="manageLoanTeamCommunication" cachelocation="false">var params = arguments[0],
	$ = skuid.$;

console.log(' popup session app id :: ' + sessionStorage.selectApplicationId);
var popover = $('.webui-popover')[0];
if (popover &amp;&amp; $(popover).is(':visible')) {
	$('.webui-popover').remove();
} else {
    $('#loan-team-communication').webuiPopover({
	    trigger: 'manual',
	    type : 'iframe',
	    url: '/apex/skuid__ui?page=LoanTeamCommunication&amp;id=' + sessionStorage.getItem('selectApplicationId'),
	    width: '820px',
	    placement: 'bottom-left',
		closeable: true,
		onShow: function(element) {
    			var popover = element[0];
    			$(popover).css('bottom', 0);
    			$(popover).find('.webui-popover-content').css('padding', 0);
    			$(popover).find('.webui-popover-content &gt; iframe').attr('id', 'ltc-popover');
    			$(popover).find('.webui-popover-content &gt; iframe').css('width', '800px');
    			$(popover).find('.webui-popover-content &gt; iframe').css('height', $(popover).css('height'));
    			$(popover).find('.webui-popover-content &gt; iframe').css('overflow','hidden');
    // 			$(popover).find('.webui-popover-content &gt; iframe').css('position', 'fixed');
		},
		onHide: function() {
		    $('.webui-popover').remove();
		}
	});
	$('#loan-team-communication').webuiPopover('show');
}</jsitem>
    </javascript>
    <css>
      <cssitem location="staticresource" name="JQueryPopoverUIPack" cachelocation="false" url="" namespace="genesisExtn" filepath="jquery.webui-popover.min.css"/>
      <cssitem location="staticresource" name="FontAwesomePack" cachelocation="false" url="" namespace="genesisExtn" filepath="font-awesome-4.6.3/css/font-awesome.css"/>
      <cssitem location="staticresource" name="CLSStyleSheetPack" cachelocation="false" url="" namespace="genesisExtn" filepath="cls-common.css"/>
      <cssitem location="staticresource" name="CLSStyleSheetPack" cachelocation="false" url="" namespace="genesisExtn" filepath="header.css"/>
    </css>
    <actionsequences/>
  </resources>
  <styles>
    <styleitem type="background" bgtype="color">
      <styles>
        <styleitem property="background-color" value="#ebeef0"/>
      </styles>
    </styleitem>
  </styles>
  <interactions/>
</skuidpage>